{"title":"使用 Verdaccio 搭建 npm 私服","uid":"5f9b4dbbcaf33940a3ac90092e96387c","slug":"build-private-npm-register-with-verdaccio","date":"2023-01-12T09:51:46.000Z","updated":"2025-11-25T03:32:50.341Z","comments":true,"path":"api/articles/build-private-npm-register-with-verdaccio.json","keywords":null,"cover":"https://images.unsplash.com/photo-1543966888-7c1dc482a810?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1506&q=80","content":"<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>Verdaccio 拉取的包存放地址为本地</p></blockquote>\n<p><a href=\"https://verdaccio.org/\">Verdaccio</a></p>\n<h2 id=\"安装-Verdaccio\"><a href=\"#安装-Verdaccio\" class=\"headerlink\" title=\"安装 Verdaccio\"></a>安装 Verdaccio</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> i <span class=\"token parameter variable\">-g</span> verdaccio<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"启动-Verdaccio\"><a href=\"#启动-Verdaccio\" class=\"headerlink\" title=\"启动 Verdaccio\"></a>启动 Verdaccio</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">verdaccio<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"访问-Verdaccio\"><a href=\"#访问-Verdaccio\" class=\"headerlink\" title=\"访问 Verdaccio\"></a>访问 Verdaccio</h2><p>启动完成之后，Web 服务默认监听在 <code>4873</code> 端口。通过浏览器访问 <code>http://localhost:4873</code> 即可看到私服页面。在启动之后的输出中，会有配置文件的存放位置，默认为： <code>/Users/userName/.config/verdaccio/config.yaml</code></p>\n<p>打开之后，能够看到 npm 包存放在本地的地址。默认为：</p>\n<pre class=\"line-numbers language-yaml\" data-language=\"yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">storage</span><span class=\"token punctuation\">:</span> /Users/userName/.local/share/verdaccio/storage<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>访问 Web：</p>\n<p><img src=\"https://res.cloudinary.com/dcuavn88i/image/upload/v1673516354/images/screenshots/lf5xw1.png\" alt=\"initial\"></p>\n<p>默认没有上传过任何私服的包，并且也没有任何登录用户。</p>\n<h2 id=\"设置用户\"><a href=\"#设置用户\" class=\"headerlink\" title=\"设置用户\"></a>设置用户</h2><ul>\n<li>新增用户<br><code>npm adduser --register http://localhost:4873</code><br>输入用户名、密码、邮箱等。</li>\n</ul>\n<p>登录 Web 端测试：</p>\n<p><img src=\"https://res.cloudinary.com/dcuavn88i/image/upload/v1673662275/images/screenshots/l9nlzw.png\" alt=\"logged\"></p>\n<h2 id=\"发布到私服\"><a href=\"#发布到私服\" class=\"headerlink\" title=\"发布到私服\"></a>发布到私服</h2><ul>\n<li>配置发布源</li>\n</ul>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\"><span class=\"token punctuation\">&#123;</span>\n  <span class=\"token property\">\"publishConfig\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token property\">\"registry\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"http://localhost:4873/\"</span>\n  <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>也可以在 <code>npm publish</code> 的时候指定 <code>register</code></li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> publish <span class=\"token parameter variable\">--register</span> http://localhost:4873<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>使用第一种修改 <code>package.json</code> 中的配置的方式，当包准备好发布时，直接执行 <code>npm publish</code> 就可以发到我们刚搭建的私服上去了。</p>\n<h2 id=\"测试发布\"><a href=\"#测试发布\" class=\"headerlink\" title=\"测试发布\"></a>测试发布</h2><ul>\n<li>我们创建的项目测试下。 <code>npm init -y</code> 静默创建 <code>package.json</code> ，修改 <code>publishConfig</code> 。包名可以使用 <code>scope</code> 的形式。</li>\n</ul>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\"><span class=\"token punctuation\">&#123;</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"@org/utils\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1.0.0\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"测试 Verdaccio\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"main\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"index.js\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token property\">\"test\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\"</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"publishConfig\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token property\">\"registry\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"http://localhost:4873/\"</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"keywords\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"author\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Zhongkang Shen\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"license\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"MIT\"</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>根目录下创建 index.js 文件，内容我们随便写一个函数导出。</li>\n</ul>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">twoSum</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token keyword\">return</span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>因为不需要任何额外依赖，也不需要什么打包配置，我们可以直接执行 npm publish 发布。</li>\n</ul>\n<p><img src=\"https://res.cloudinary.com/dcuavn88i/image/upload/v1673662334/images/screenshots/x31xn9.png\" alt=\"publish\"></p>\n<ul>\n<li>发布成功之后，打开 Web 页面查看。</li>\n</ul>\n<p><img src=\"https://res.cloudinary.com/dcuavn88i/image/upload/v1673662380/images/screenshots/iaoji9.png\" alt=\"v1\"></p>\n<p><img src=\"https://res.cloudinary.com/dcuavn88i/image/upload/v1673662447/images/screenshots/ilqai7.png\" alt=\"v1-detail\"></p>\n<p>因为没有 <code>README.md</code>文件，我们查看包详细信息的时候，是空白的。我们增加一个包的简单说明，然后给这个包升级发布。</p>\n<p><img src=\"https://res.cloudinary.com/dcuavn88i/image/upload/v1673662496/images/screenshots/xzlxk1.png\" alt=\"readme\"></p>\n<p>修改版本号为 <code>1.0.1</code> 然后执行 <code>npm publish</code> 发布。再次来到 Web 页面：</p>\n<p><img src=\"https://res.cloudinary.com/dcuavn88i/image/upload/v1673662535/images/screenshots/cryrrs.png\" alt=\"about\"></p>\n<p>已经发布成功，并且添加了 <code>README</code> 。在版本中，可以查看到我们发布的历史版本记录。</p>\n<p><img src=\"https://res.cloudinary.com/dcuavn88i/image/upload/v1673662570/images/screenshots/bqmu4u.png\" alt=\"v2\"></p>\n<h2 id=\"删除包\"><a href=\"#删除包\" class=\"headerlink\" title=\"删除包\"></a>删除包</h2><p>通过 <code>storage</code> 配置中的地址，访问查看我们本地存储的所有包。直接删除指定的包，就不会在 Web 里查看到了。</p>\n","text":" Verdaccio 拉取的包存放地址为本地 Verdaccio 安装 Verdaccionpm i -g verdaccio 启动 Verdaccioverdaccio 访问 Verdaccio启动完成之后，Web 服务默认监听在 4873 端口。通过浏览器访问 http://...","link":"","photos":[],"count_time":{"symbolsCount":"1.5k","symbolsTime":"1 mins."},"categories":[{"name":"frontend","slug":"frontend","count":13,"path":"api/categories/frontend.json"},{"name":"npm","slug":"frontend/npm","count":1,"path":"api/categories/frontend/npm.json"}],"tags":[{"name":"frontend","slug":"frontend","count":12,"path":"api/tags/frontend.json"},{"name":"node","slug":"node","count":3,"path":"api/tags/node.json"},{"name":"npm","slug":"npm","count":2,"path":"api/tags/npm.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85-Verdaccio\"><span class=\"toc-text\">安装 Verdaccio</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%90%AF%E5%8A%A8-Verdaccio\"><span class=\"toc-text\">启动 Verdaccio</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%AE%BF%E9%97%AE-Verdaccio\"><span class=\"toc-text\">访问 Verdaccio</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%AE%BE%E7%BD%AE%E7%94%A8%E6%88%B7\"><span class=\"toc-text\">设置用户</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8F%91%E5%B8%83%E5%88%B0%E7%A7%81%E6%9C%8D\"><span class=\"toc-text\">发布到私服</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%B5%8B%E8%AF%95%E5%8F%91%E5%B8%83\"><span class=\"toc-text\">测试发布</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%88%A0%E9%99%A4%E5%8C%85\"><span class=\"toc-text\">删除包</span></a></li></ol>","author":{"name":"Ethan Shen","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/18032128?s=96&v=4","link":"/","description":"太阳玄烨","socials":{"github":"https://github.com/shenzhongkang","twitter":"https://twitter.com/shenzhongkang","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/shenzhongkang","zhihu":"","csdn":"https://blog.csdn.net/shenzhongkang","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"前端入门指导","uid":"9ba2999e5509533e00deb0ba82c03ca2","slug":"frontend-guide","date":"2023-01-13T01:51:39.000Z","updated":"2025-11-25T03:32:50.342Z","comments":true,"path":"api/articles/frontend-guide.json","keywords":null,"cover":"https://images.unsplash.com/photo-1621839673705-6617adf9e890?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1632&q=80","text":"前端开发着路径参见 Roadmap，每年会有一定程度的更新。 推荐的学习网站 Youtube 偏向于视频学习的话，Youtube 上能够找到大量的学习教程，很多也都归纳为一些系列，归档到一个视频列表中，十分方便。Youtube 上种类很多，前后端框架、技术点、工具等等，都能够找到...","link":"","photos":[],"count_time":{"symbolsCount":"1.5k","symbolsTime":"1 mins."},"categories":[{"name":"frontend","slug":"frontend","count":13,"path":"api/categories/frontend.json"},{"name":"tutorial","slug":"frontend/tutorial","count":2,"path":"api/categories/frontend/tutorial.json"}],"tags":[{"name":"frontend","slug":"frontend","count":12,"path":"api/tags/frontend.json"},{"name":"javascript","slug":"javascript","count":5,"path":"api/tags/javascript.json"},{"name":"tutorial","slug":"tutorial","count":1,"path":"api/tags/tutorial.json"}],"author":{"name":"Ethan Shen","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/18032128?s=96&v=4","link":"/","description":"太阳玄烨","socials":{"github":"https://github.com/shenzhongkang","twitter":"https://twitter.com/shenzhongkang","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/shenzhongkang","zhihu":"","csdn":"https://blog.csdn.net/shenzhongkang","juejin":"","customs":{}}}},"next_post":{"title":"ServiceNow Jelly tags","uid":"8bb4189dd0fa7fb30567f50c7f73bb69","slug":"servicenow-jelly-tags","date":"2022-08-31T06:02:58.000Z","updated":"2025-11-25T03:32:50.343Z","comments":true,"path":"api/articles/servicenow-jelly-tags.json","keywords":null,"cover":"https://images.unsplash.com/photo-1661956602868-6ae368943878?ixlib=rb-4.0.3&ixid=MnwxMjA3fDF8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=2340&q=80","text":"Jelly tags - Jelly 标签Jelly用来将 XML 转换为 HTML。 Jelly 标签if 描述：if标签如你所见，用来做条件判断的，但是这里需要主要，没有所谓的 elseif和 else标签，如果需要表达否则的这种的判断，请使用 choose&#x2F; wh...","link":"","photos":[],"count_time":{"symbolsCount":"7k","symbolsTime":"6 mins."},"categories":[{"name":"servicenow","slug":"servicenow","count":1,"path":"api/categories/servicenow.json"},{"name":"article","slug":"servicenow/article","count":1,"path":"api/categories/servicenow/article.json"}],"tags":[{"name":"servicenow","slug":"servicenow","count":2,"path":"api/tags/servicenow.json"},{"name":"jelly","slug":"jelly","count":1,"path":"api/tags/jelly.json"}],"author":{"name":"Ethan Shen","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/18032128?s=96&v=4","link":"/","description":"太阳玄烨","socials":{"github":"https://github.com/shenzhongkang","twitter":"https://twitter.com/shenzhongkang","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/shenzhongkang","zhihu":"","csdn":"https://blog.csdn.net/shenzhongkang","juejin":"","customs":{}}}}}